<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title>滚动刷新:ion-infinite-scroll</title>
      <link href="lib/ionic/css/ionic.css" rel="stylesheet">
      <script src="lib/ionic/js/ionic.bundle.min.js"></script>
  </head>
  <body ng-app="starter">
      <ion-header-bar  class="bar-positive">
          <h4>这里是头部</h4>
      </ion-header-bar>
      <ion-content ng-controller="myCtrl">
          <ul class="list">
              <li class="item" ng-repeat="item in items">{{item}}</li>
              <li class="item" ng-if="!moreDataCanBeLoaded()">没有更多数据喽</li>
          </ul>
          <ion-infinite-scroll ng-if="moreDataCanBeLoaded()"
                               on-infinite="loadMore()" distance="1%">
          </ion-infinite-scroll>
      </ion-content>
      <ion-footer-bar class="bar-positive">
              <h4>这里是底部</h4>
      </ion-footer-bar>
  </body>
  <script>
      //定义控制器
      angular.module("starter",["ionic"]).controller("myCtrl",function($scope,$timeout){
          //初始化加载更多数据的次数
          $scope.loadTimes=0;
          //定义判断是否可以加载更多数据的函数
          $scope.moreDataCanBeLoaded=function(){
              return $scope.loadTimes<3;
          }
          //初始化数据
          $scope.items=[];
          $scope.data=[];
          for(var i=1;i<=30;i++){
              $scope.data.push("第"+i+"条数据");
          }
          $scope.pageSize=10;
          //页面滚动到底部需要调用的方法
          $scope.loadMore = function() {
              //定义定时器，延时加载可以看到加载图标效果
              $timeout(function () {
                  $scope.start=$scope.pageSize*($scope.loadTimes-1);
                  $scope.items= $scope.data.slice($scope.start,$scope.start+$scope.pageSize);
                  //加载完毕通知容器更新滚动视图（收起图标）
                  $scope.loadTimes=$scope.loadTimes+1;
                  $scope.$broadcast('scroll.infiniteScrollComplete');
              }, 1000);
              $scope.$on('stateChangeSuccess', function() {
                  $scope.loadMore();
              });
          }
      });
  </script>
</html>
